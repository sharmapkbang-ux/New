'use client';
import { useState } from 'react';
export default function PersonaChat(){ const [messages,setMessages]=useState<any[]>([]); const [text,setText]=useState(''); async function send(){ if(!text) return; setMessages(prev=>[...prev,{role:'user',text}]); try{ const r = await fetch('/api/persona/chat',{method:'POST',headers:{'Content-Type':'application/json'},body: JSON.stringify({ message: text })}); const j = await r.json(); setMessages(prev=>[...prev,{role:'ai',text: j.reply || '(no reply)'}]); }catch(e){ setMessages(prev=>[...prev,{role:'ai',text:'(persona fallback)'}]); } setText(''); } return (<div style={{border:'1px solid #e2e8f0',padding:12,borderRadius:8}}><div style={{height:220,overflow:'auto'}}>{messages.map((m,i)=>(<div key={i} style={{textAlign:m.role==='user'?'right':'left'}}><b>{m.role}</b>: {m.text}</div>))}</div><textarea value={text} onChange={e=>setText(e.target.value)} style={{width:'100%',height:70}} /><div style={{marginTop:8}}><button onClick={send}>Send</button></div></div>); }
